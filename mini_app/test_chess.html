<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –®–∞—Ö–º–∞—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }
        .status {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        button {
            background: #3390ec;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        button:hover {
            background: #2980d9;
        }
        .chess-board {
            width: 320px;
            height: 320px;
            border: 2px solid #8b4513;
            margin: 20px auto;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
        }
        .square {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
        }
        .light { background: #f0d9b5; }
        .dark { background: #b58863; }
        .square:hover { background: #7fb069 !important; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ôüÔ∏è –¢–µ—Å—Ç –®–∞—Ö–º–∞—Ç</h1>
        
        <div class="status" id="status">
            üéÆ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!
        </div>
        
        <button onclick="testConnection()">üîå –¢–µ—Å—Ç —Å–≤—è–∑–∏ —Å –±–æ—Ç–æ–º</button>
        <button onclick="startGame()">üöÄ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        
        <div class="chess-board" id="board">
            <!-- –î–æ—Å–∫–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ —á–µ—Ä–µ–∑ JS -->
        </div>
        
        <div class="status" id="debug">
            üìä –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        
        function updateStatus(message) {
            document.getElementById('status').innerHTML = message;
        }
        
        function updateDebug(message) {
            document.getElementById('debug').innerHTML = message;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É Telegram WebApp
        if (tg) {
            tg.ready();
            tg.expand();
            
            updateStatus('üéÆ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω!');
            updateDebug(`üì± Platform: ${tg.platform || 'unknown'}<br>üÜî User ID: ${tg.initDataUnsafe?.user?.id || 'unknown'}`);
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            tg.MainButton.text = "–ó–∞–∫—Ä—ã—Ç—å –∏–≥—Ä—É";
            tg.MainButton.show();
            
            tg.onEvent('mainButtonClicked', function() {
                tg.close();
            });
            
        } else {
            updateStatus('‚ùå Telegram WebApp –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            updateDebug('–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –≤ Telegram');
        }
        
        function testConnection() {
            updateStatus('üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–≤—è–∑—å —Å –±–æ—Ç–æ–º...');
            
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify({
                    action: 'test_connection',
                    message: '–ü—Ä–∏–≤–µ—Ç –æ—Ç Mini App!'
                }));
                updateStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –±–æ—Ç—É!');
            } else {
                updateStatus('‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ');
            }
        }
        
        function startGame() {
            updateStatus('üéØ –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É...');
            
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify({
                    action: 'start_game',
                    difficulty: 'medium',
                    playerColor: 'white'
                }));
                updateStatus('üéÆ –ò–≥—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–∞—Ç —Å –±–æ—Ç–æ–º.');
            } else {
                updateStatus('‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É');
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é –¥–æ—Å–∫—É
        function createBoard() {
            const board = document.getElementById('board');
            
            // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
            const pieces = [
                ['‚ôú','‚ôû','‚ôù','‚ôõ','‚ôö','‚ôù','‚ôû','‚ôú'],
                ['‚ôü','‚ôü','‚ôü','‚ôü','‚ôü','‚ôü','‚ôü','‚ôü'],
                ['','','','','','','',''],
                ['','','','','','','',''],
                ['','','','','','','',''],
                ['','','','','','','',''],
                ['‚ôô','‚ôô','‚ôô','‚ôô','‚ôô','‚ôô','‚ôô','‚ôô'],
                ['‚ôñ','‚ôò','‚ôó','‚ôï','‚ôî','‚ôó','‚ôò','‚ôñ']
            ];
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = `square ${(row + col) % 2 === 0 ? 'light' : 'dark'}`;
                    square.textContent = pieces[row][col];
                    
                    square.onclick = () => {
                        updateDebug(`üéØ –ö–ª–∏–∫ –Ω–∞ –∫–ª–µ—Ç–∫—É: ${String.fromCharCode(97 + col)}${8 - row}`);
                    };
                    
                    board.appendChild(square);
                }
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º –¥–æ—Å–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        createBoard();
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        window.addEventListener('message', function(event) {
            updateDebug(`üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: ${JSON.stringify(event.data)}`);
        });
        
    </script>
</body>
</html>
